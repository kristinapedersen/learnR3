---
title: "Draft R Markdown document"
author: "Your Name"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(vroom)
library(here)
library(fs)
library(tidyverse)
source(here("R/functions.R")) #runs all the functions I have make at once
```

## Extract user_id:

```{r}
user_info_df <- import_multiple_files("user_info.csv",
                                      import_user_info)
saliva_data_df <- import_multiple_files("saliva.csv",
                                        import_saliva_data)
rr_df <- import_multiple_files("RR.csv",
                               import_RR_data)

Actigraph_df <- import_multiple_files("Actigraph.csv",
                                      import_Actigraph_data)

```

#add numbers
```{r}
add_numbers <- function(num1,num2){
    added <- num1 + num2
    return(added)
}
```



##joining data

```{r}
full_join(user_info_df, saliva_data_df, by ="user_id")
```

##Working with reduce

```{r}
# Split and summarise data
summarised_Actigraph_df <- Actigraph_df %>%
  group_by(user_id) %>%
  summarise(across(hr,
                   list(Mean = mean,
                        SD = sd), na.rm = TRUE)) %>%
  ungroup()

# Split and summarise data
summarised_rr_df <- rr_df %>%
  group_by(day, user_id) %>%
  summarise(across(ibi_s,
                   list(Mean = mean,
                        SD = sd), na.rm = TRUE)) %>%
  ungroup()
```


```{r}
#Example:
reduce(list(user_info_df,saliva_data_df, summarised_rr_df), full_join)


```
```{r}
user_info_df %>%
    mutate(age_category = case_when(age > 20 ~ "old",
                                    age <= 20 ~ "young",
                                    TRUE~"unborn!"
    ))
```

```{r}
saliva_with_data_df <- saliva_data_df %>%
    mutate(day = case_when(
        samples == "before sleep" ~ 1, 
        samples == "wake up" ~ 2,
        TRUE ~ NA_real_
    ))

mmash <- reduce(list(user_info_df,saliva_with_data_df, summarised_rr_df, summarised_Actigraph_df), full_join)
```

